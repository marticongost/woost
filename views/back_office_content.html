<?python
from magicbullet.html import Element
from magicbullet.html.table import Table, MULTIPLE_SELECTION
from magicbullet.schema import Member
from magicbullet.models import Item

item_type = Item

table = Table()
table["name"] = "content"
table.selection_mode = MULTIPLE_SELECTION
table.data = Item.index.values()
table.schema = item_type.copy(
    inheritance = False,
    validations = False,
    exclude = ("id", "translations", "groups"),
    members = (Member(name = "element"),)
)
table.schema.name = "BackOfficeContentTable"
table.schema.members_order.insert(0, "element")

def display_element(table, item, member):
    display = Element()
    display.append(translate(item))
    for schema in item.__class__.descend_inheritance(True):
        display.add_class(schema.name)
    return display

table.set_member_display("element", display_element)
?>

<html
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude">

    <div py:match="body-block">
        <form method="get">

			<div id="toolbar">
				<button name="new">
					<img src="${cms.uri('resources', 'images', 'new.png')}"/>
					<label>New item</label>
				</button>
				<button name="edit">
					<img src="${cms.uri('resources', 'images', 'edit.png')}"/>
					<label>Edit</label>
				</button>
				<button name="delete">
					<img src="${cms.uri('resources', 'images', 'delete.png')}"/>
					<label>Delete</label>
				</button>
				<button name="history">
					<img src="${cms.uri('resources', 'images', 'history.png')}"/>
					<label>History</label>
				</button>
			</div>

			<?python
            from cherrypy import request
            print ">" * 80
            print request.params.get("content_selection")
            print ">" * 80
            ?>
            ${Markup(table.render())}
        </form>
    </div>

    <xi:include href="back_office_layout.html"/>

</html>
